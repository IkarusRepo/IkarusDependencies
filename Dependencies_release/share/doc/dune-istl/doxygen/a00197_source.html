<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dune-istl: solver.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dune-istl
   &#160;<span id="projectnumber">2.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b8b565de3f42c43d20f21e2cb1a39db5.html">dune-istl</a></li><li class="navelem"><a class="el" href="dir_0db5ea851c640d2cb3de351510d7ca77.html">dune</a></li><li class="navelem"><a class="el" href="dir_076cadbab1aab890d8de2944aa4b23a3.html">istl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">solver.hh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00197.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// vi: set et ts=4 sw=2 sts=2:</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef DUNE_ISTL_SOLVER_HH</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#define DUNE_ISTL_SOLVER_HH</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;dune/common/exceptions.hh&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;dune/common/shared_ptr.hh&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;dune/common/simd/io.hh&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;dune/common/simd/simd.hh&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;dune/common/parametertree.hh&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;dune/common/timer.hh&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00212.html">solvertype.hh</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00179.html">preconditioner.hh</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00104.html">operators.hh</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00188.html">scalarproducts.hh</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">namespace </span><a class="code" href="a00252.html">Dune</a></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="a02675.html">   45</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="a02675.html">InverseOperatorResult</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  {</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="a02675.html#a007457c192debe371ae62caa3db02127">   48</a></span>&#160;    <a class="code" href="a02675.html#a007457c192debe371ae62caa3db02127">InverseOperatorResult</a> ()</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="a02675.html#af6eb51e594a8cb7ab84cabd5e5743b77">clear</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="a02675.html#af6eb51e594a8cb7ab84cabd5e5743b77">   54</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a02675.html#af6eb51e594a8cb7ab84cabd5e5743b77">clear</a> ()</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">iterations</a> = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">reduction</a> = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">converged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">conv_rate</a> = 1;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">elapsed</a> = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <a class="code" href="a02675.html#a53279693ec639d61538909b952ede7ab">condition_estimate</a> = -1;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">   65</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">iterations</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">   68</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">reduction</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">   71</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">converged</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">   74</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">conv_rate</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="a02675.html#a53279693ec639d61538909b952ede7ab">   77</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a02675.html#a53279693ec639d61538909b952ede7ab">condition_estimate</a> = -1;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">   80</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">elapsed</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  };</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span>  <span class="keyword">template</span>&lt;<span class="keyword">class</span> X, <span class="keyword">class</span> Y&gt;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="a02679.html">   97</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a02679.html">InverseOperator</a> {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="a02679.html#aaba59848baa4879b548d96b9f77e150a">  100</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a02679.html#aaba59848baa4879b548d96b9f77e150a">domain_type</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="a02679.html#a85b7df40fa5e6a60c2a3db25a4140823">  103</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a02679.html#a85b7df40fa5e6a60c2a3db25a4140823">range_type</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="a02679.html#adce5c3d7c39415d90326ccc06b94b9dc">  106</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a02679.html#adce5c3d7c39415d90326ccc06b94b9dc">field_type</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">  109</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> FieldTraits&lt;field_type&gt;::real_type <a class="code" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">real_type</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">  112</a></span>&#160;    <span class="keyword">typedef</span> Simd::Scalar&lt;real_type&gt; <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="a02679.html#aaef4f0b84f4a983421f15b6eea8c69ab">  126</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a02679.html#aaef4f0b84f4a983421f15b6eea8c69ab">apply</a> (X&amp; x, Y&amp; b, <a class="code" href="a02675.html">InverseOperatorResult</a>&amp; res) = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="a02679.html#a57a25fc54525ae58726ec0f274d5cc29">  141</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a02679.html#a57a25fc54525ae58726ec0f274d5cc29">apply</a> (X&amp; x, Y&amp; b, <span class="keywordtype">double</span> reduction, <a class="code" href="a02675.html">InverseOperatorResult</a>&amp; res) = 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="a02679.html#ae74604dd6afec05c0e2a080fe403d2a1">  144</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733">SolverCategory::Category</a> <a class="code" href="a02679.html#ae74604dd6afec05c0e2a080fe403d2a1">category</a>() const</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#ifdef DUNE_ISTL_SUPPORT_OLD_CATEGORY_INTERFACE</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      DUNE_THROW(Dune::Exception,<span class="stringliteral">&quot;It is necessary to implement the category method in a derived classes, in the future this method will pure virtual.&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    = 0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="a02679.html#a0c15f8be3b793a367af0b0cb324a942d">  154</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="a02679.html#a0c15f8be3b793a367af0b0cb324a942d">~InverseOperator</a> () {}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// spacing values</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">  158</a></span>&#160;    <span class="keyword">enum</span> { <a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">iterationSpacing</a> = 5 , <a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a> = 16 };</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="a02679.html#a07986680755603e2cc783f8be1994d1f">  161</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a02679.html#a07986680755603e2cc783f8be1994d1f">printHeader</a>(std::ostream&amp; s)<span class="keyword"> const</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">iterationSpacing</a>)  &lt;&lt; <span class="stringliteral">&quot; Iter&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a>) &lt;&lt; <span class="stringliteral">&quot;Defect&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a>) &lt;&lt; <span class="stringliteral">&quot;Rate&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CountType, <span class="keyword">typename</span> DataType&gt;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="a02679.html#a45229eb4007296995264f4277a89b51c">  170</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a02679.html#a45229eb4007296995264f4277a89b51c">printOutput</a>(std::ostream&amp; s,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                     <span class="keyword">const</span> CountType&amp; iter,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                     <span class="keyword">const</span> DataType&amp; norm,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     <span class="keyword">const</span> DataType&amp; norm_old)<span class="keyword"> const</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keyword">const</span> DataType rate = norm/norm_old;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">iterationSpacing</a>)  &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a>) &lt;&lt; Simd::io(norm) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a>) &lt;&lt; Simd::io(rate) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CountType, <span class="keyword">typename</span> DataType&gt;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="a02679.html#a1c5876dba1ae3409f017e30cbd0a7838">  183</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a02679.html#a1c5876dba1ae3409f017e30cbd0a7838">printOutput</a>(std::ostream&amp; s,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                     <span class="keyword">const</span> CountType&amp; iter,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                     <span class="keyword">const</span> DataType&amp; norm)<span class="keyword"> const</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">iterationSpacing</a>)  &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      s &lt;&lt; std::setw(<a class="code" href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">normSpacing</a>) &lt;&lt; Simd::io(norm) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  };</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> X, <span class="keyword">class</span> Y&gt;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="a02683.html">  201</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a02683.html">IterativeSolver</a> : <span class="keyword">public</span> <a class="code" href="a02679.html">InverseOperator</a>&lt;X,Y&gt;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="a02679.html#aaba59848baa4879b548d96b9f77e150a">InverseOperator&lt;X,Y&gt;::domain_type</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="a02679.html#a85b7df40fa5e6a60c2a3db25a4140823">InverseOperator&lt;X,Y&gt;::range_type</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="a02679.html#adce5c3d7c39415d90326ccc06b94b9dc">InverseOperator&lt;X,Y&gt;::field_type</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">InverseOperator&lt;X,Y&gt;::real_type</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">using</span> <span class="keyword">typename</span> <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">InverseOperator&lt;X,Y&gt;::scalar_real_type</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="a02683.html#aa3aac0420d78c7e981855173998dfdbd">  228</a></span>&#160;    <a class="code" href="a02683.html#aa3aac0420d78c7e981855173998dfdbd">IterativeSolver</a> (<a class="code" href="a01819.html">LinearOperator&lt;X,Y&gt;</a>&amp; op, <a class="code" href="a02583.html">Preconditioner&lt;X,Y&gt;</a>&amp; prec, <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a> reduction, <span class="keywordtype">int</span> maxit, <span class="keywordtype">int</span> verbose) :</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">_op</a>(stackobject_to_shared_ptr(op)),</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="a02683.html#af4a8a49af428c01332ca8254f124de3e">_prec</a>(stackobject_to_shared_ptr(prec)),</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">_sp</a>(new <a class="code" href="a02647.html">SeqScalarProduct</a>&lt;X&gt;),</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>(reduction), <a class="code" href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">_maxit</a>(maxit), <a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>(verbose), <a class="code" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">_category</a>(<a class="code" href="a02703.html">SolverCategory</a>::sequential)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(op) != <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9">SolverCategory::sequential</a>)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;LinearOperator has to be sequential!&quot;</span>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(prec) != <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9">SolverCategory::sequential</a>)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;Preconditioner has to be sequential!&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="a02683.html#a2e5c17e2cf1c34f2ff6c696d551c3acb">  260</a></span>&#160;    <a class="code" href="a02683.html#a2e5c17e2cf1c34f2ff6c696d551c3acb">IterativeSolver</a> (<a class="code" href="a01819.html">LinearOperator&lt;X,Y&gt;</a>&amp; op, <a class="code" href="a02639.html">ScalarProduct&lt;X&gt;</a>&amp; sp, <a class="code" href="a02583.html">Preconditioner&lt;X,Y&gt;</a>&amp; prec,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a> reduction, <span class="keywordtype">int</span> maxit, <span class="keywordtype">int</span> verbose) :</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">_op</a>(stackobject_to_shared_ptr(op)),</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="a02683.html#af4a8a49af428c01332ca8254f124de3e">_prec</a>(stackobject_to_shared_ptr(prec)),</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">_sp</a>(stackobject_to_shared_ptr(sp)),</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>(reduction), <a class="code" href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">_maxit</a>(maxit), <a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>(verbose), <a class="code" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">_category</a>(<a class="code" href="a02703.html">SolverCategory</a>::<a class="code" href="a02683.html#af4e81a96530540ab4040226ad3346c51">category</a>(op))</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(op) != <a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(prec))</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;LinearOperator and Preconditioner must have the same SolverCategory!&quot;</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(op) != <a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(sp))</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;LinearOperator and ScalarProduct must have the same SolverCategory!&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="a02683.html#a95ff9476da2017980a0574aa0c3d3048">  288</a></span>&#160;    <a class="code" href="a02683.html#a95ff9476da2017980a0574aa0c3d3048">IterativeSolver</a> (std::shared_ptr&lt;<a class="code" href="a01819.html">LinearOperator&lt;X,Y&gt;</a> &gt; op, std::shared_ptr&lt;<a class="code" href="a02583.html">Preconditioner&lt;X,X&gt;</a> &gt; prec, <span class="keyword">const</span> ParameterTree&amp; configuration) :</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="a02683.html">IterativeSolver</a>(op,std::make_shared&lt;<a class="code" href="a02647.html">SeqScalarProduct</a>&lt;X&gt;&gt;(),prec,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;<a class="code" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">real_type</a>&gt;(<span class="stringliteral">&quot;reduction&quot;</span>),</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;int&gt;(<span class="stringliteral">&quot;maxit&quot;</span>),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;int&gt;(<span class="stringliteral">&quot;verbose&quot;</span>))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    {}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="a02683.html#af2fa55775d41709b976bfa306d8cd50e">  311</a></span>&#160;    <a class="code" href="a02683.html#af2fa55775d41709b976bfa306d8cd50e">IterativeSolver</a> (std::shared_ptr&lt;<a class="code" href="a01819.html">LinearOperator&lt;X,Y&gt;</a> &gt; op, std::shared_ptr&lt;<a class="code" href="a02639.html">ScalarProduct&lt;X&gt;</a> &gt; sp, std::shared_ptr&lt;<a class="code" href="a02583.html">Preconditioner&lt;X,X&gt;</a> &gt; prec, <span class="keyword">const</span> ParameterTree&amp; configuration) :</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="a02683.html">IterativeSolver</a>(op,sp,prec,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;<a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a>&gt;(<span class="stringliteral">&quot;reduction&quot;</span>),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;int&gt;(<span class="stringliteral">&quot;maxit&quot;</span>),</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        configuration.<a class="code" href="a00252.html#a405d30f54803def97082030c715c8791">get</a>&lt;int&gt;(<span class="stringliteral">&quot;verbose&quot;</span>))</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="a02683.html#a9591f7951c8d340cda51ad6093ac9c12">  338</a></span>&#160;    <a class="code" href="a02683.html#a9591f7951c8d340cda51ad6093ac9c12">IterativeSolver</a> (std::shared_ptr&lt;<a class="code" href="a01819.html">LinearOperator&lt;X,Y&gt;</a>&gt; op,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                     std::shared_ptr&lt;<a class="code" href="a02639.html">ScalarProduct&lt;X&gt;</a>&gt; sp,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                     std::shared_ptr&lt;<a class="code" href="a02583.html">Preconditioner&lt;X,Y&gt;</a>&gt; prec,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                     <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a> reduction, <span class="keywordtype">int</span> maxit, <span class="keywordtype">int</span> verbose) :</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">_op</a>(op),</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="a02683.html#af4a8a49af428c01332ca8254f124de3e">_prec</a>(prec),</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">_sp</a>(sp),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>(reduction), <a class="code" href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">_maxit</a>(maxit), <a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>(verbose),</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">_category</a>(<a class="code" href="a02703.html">SolverCategory</a>::<a class="code" href="a02683.html#af4e81a96530540ab4040226ad3346c51">category</a>(*op))</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(*op) != <a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(*prec))</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;LinearOperator and Preconditioner must have the same SolverCategory!&quot;</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(*op) != <a class="code" href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">SolverCategory::category</a>(*sp))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        DUNE_THROW(<a class="code" href="a02707.html">InvalidSolverCategory</a>, <span class="stringliteral">&quot;LinearOperator and ScalarProduct must have the same SolverCategory!&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// #warning actually we want to have this as the default and just implement the second one</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// //! \copydoc InverseOperator::apply(X&amp;,Y&amp;,InverseOperatorResult&amp;)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// virtual void apply (X&amp; x, Y&amp; b, InverseOperatorResult&amp; res)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//   apply(x,b,_reduction,res);</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifndef DOXYGEN</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// make sure the three-argument apply from the base class does not get shadowed</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// by the redefined four-argument version below</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">using</span> <a class="code" href="a02679.html">InverseOperator&lt;X,Y&gt;::apply</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="a02683.html#a42273cb037e81940486a2109adf4a941">  372</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a02683.html#a42273cb037e81940486a2109adf4a941">apply</a> (X&amp; x, X&amp; b, <span class="keywordtype">double</span> reduction, <a class="code" href="a02675.html">InverseOperatorResult</a>&amp; res)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a> saved_reduction = <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a> = reduction;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      this-&gt;<a class="code" href="a02683.html#a42273cb037e81940486a2109adf4a941">apply</a>(x,b,res);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a> = saved_reduction;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="a02683.html#af4e81a96530540ab4040226ad3346c51">  381</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733">SolverCategory::Category</a> <a class="code" href="a02683.html#af4e81a96530540ab4040226ad3346c51">category</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">_category</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">  386</a></span>&#160;    std::string <a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      std::string <a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a> = className(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>.substr(0, <a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>.find(<span class="stringliteral">&quot;&lt;&quot;</span>));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> CountType = <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="a02687.html">  409</a></span>&#160;    <span class="keyword">class </span><a class="code" href="a02687.html">Iteration</a> {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="a02687.html#a01db9f251b305695f6ede7edae579970">  411</a></span>&#160;      <a class="code" href="a02687.html#a01db9f251b305695f6ede7edae579970">Iteration</a>(<span class="keyword">const</span> <a class="code" href="a02683.html">IterativeSolver</a>&amp; parent, <a class="code" href="a02675.html">InverseOperatorResult</a>&amp; res)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        : <a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>(0)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        , <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>(res)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        , <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>(parent)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        , <a class="code" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">_valid</a>(true)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        res.<a class="code" href="a02675.html#af6eb51e594a8cb7ab84cabd5e5743b77">clear</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>&gt;0){</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;=== &quot;</span> &lt;&lt; parent.<a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a> &gt; 1)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02679.html#a07986680755603e2cc783f8be1994d1f">printHeader</a>(std::cout);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="a02687.html#a84153f8c63471c148532d3bcddcce54b">  425</a></span>&#160;      <a class="code" href="a02687.html#a84153f8c63471c148532d3bcddcce54b">Iteration</a>(<span class="keyword">const</span> <a class="code" href="a02687.html">Iteration</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="a02687.html#a0870995022d0c5e1cee1f1b8fa84d6cd">  426</a></span>&#160;      <a class="code" href="a02687.html#a0870995022d0c5e1cee1f1b8fa84d6cd">Iteration</a>(<a class="code" href="a02687.html">Iteration</a>&amp;&amp; other)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        : <a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a>(other.<a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a>)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        , <a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>(other.<a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        , <a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>(other.<a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        , <a class="code" href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">_watch</a>(other.<a class="code" href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">_watch</a>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        , <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>(other.<a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        , <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>(other.<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        , <a class="code" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">_valid</a>(other.<a class="code" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">_valid</a>)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        other._valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="a02687.html#ae5a464a44d3df1b30f1452a7e313d2c2">  438</a></span>&#160;      <a class="code" href="a02687.html#ae5a464a44d3df1b30f1452a7e313d2c2">~Iteration</a>(){</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">_valid</a>)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <a class="code" href="a02687.html#adb9ada3a3a9fa9b0e6d5955f4e17d04e">finalize</a>();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="a02687.html#ac6ab252966c7aff8bcd672ea58d0361a">  453</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="a02687.html#ac6ab252966c7aff8bcd672ea58d0361a">step</a>(CountType i, <a class="code" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">real_type</a> def){</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (!Simd::allTrue(isFinite(def))) <span class="comment">// check for inf or NaN</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>&gt;0)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;=== &quot;</span> &lt;&lt; <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>() &lt;&lt; <span class="stringliteral">&quot;: abort due to infinite or NaN defect&quot;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          DUNE_THROW(<a class="code" href="a01395.html">SolverAbort</a>,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                     <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">name</a>() &lt;&lt; <span class="stringliteral">&quot;: defect=&quot;</span> &lt;&lt; Simd::io(def)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; is infinite or NaN&quot;</span>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span>(i == 0)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a> = def;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a> &gt; 1){</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          <span class="keywordflow">if</span>(i!=0)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02679.html#a45229eb4007296995264f4277a89b51c">printOutput</a>(std::cout,i,def,<a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02679.html#a45229eb4007296995264f4277a89b51c">printOutput</a>(std::cout,i,def);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a> = def;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a> = i;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">converged</a> = (Simd::allTrue(def&lt;<a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a>*<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>) || Simd::max(def)&lt;1E-30);    <span class="comment">// convergence check</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">converged</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="a02687.html#adb9ada3a3a9fa9b0e6d5955f4e17d04e">  478</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a02687.html#adb9ada3a3a9fa9b0e6d5955f4e17d04e">finalize</a>(){</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">converged</a> = (Simd::allTrue(<a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>&lt;<a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a>*<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>) || Simd::max(<a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>)&lt;1E-30);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">iterations</a> = <a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">reduction</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(Simd::max(<a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a>/<a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a>));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">conv_rate</a>  = pow(<a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">reduction</a>,1.0/<a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">elapsed</a> = <a class="code" href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">_watch</a>.elapsed();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>.<a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>&gt;0)                 <span class="comment">// final print</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;          {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;=== rate=&quot;</span> &lt;&lt; <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">conv_rate</a></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, T=&quot;</span> &lt;&lt; <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">elapsed</a></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, TIT=&quot;</span> &lt;&lt; <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">elapsed</a>/<a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">iterations</a></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, IT=&quot;</span> &lt;&lt; <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>.<a class="code" href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">iterations</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">  493</a></span>&#160;      <a class="code" href="a02679.html#ae08de8ceccc057d0785cfda953796a81">real_type</a> <a class="code" href="a02687.html#ab225834a68c68d6289badd96f4e783e0">_def0</a> = 0.0, <a class="code" href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">_def</a> = 0.0;</div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">  494</a></span>&#160;      CountType <a class="code" href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">_i</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">  495</a></span>&#160;      Timer <a class="code" href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">_watch</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">  496</a></span>&#160;      <a class="code" href="a02675.html">InverseOperatorResult</a>&amp; <a class="code" href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">_res</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">  497</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="a02683.html">IterativeSolver</a>&amp; <a class="code" href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">_parent</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">  498</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">_valid</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    };</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">  502</a></span>&#160;    std::shared_ptr&lt;LinearOperator&lt;X,Y&gt;&gt; <a class="code" href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">_op</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="a02683.html#af4a8a49af428c01332ca8254f124de3e">  503</a></span>&#160;    std::shared_ptr&lt;Preconditioner&lt;X,Y&gt;&gt; <a class="code" href="a02683.html#af4a8a49af428c01332ca8254f124de3e">_prec</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">  504</a></span>&#160;    std::shared_ptr&lt;ScalarProduct&lt;X&gt;&gt; <a class="code" href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">_sp</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">  505</a></span>&#160;    <a class="code" href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">scalar_real_type</a> <a class="code" href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">_reduction</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">  506</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">_maxit</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">  507</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">_verbose</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">  508</a></span>&#160;    <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733">SolverCategory::Category</a> <a class="code" href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">_category</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  };</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ISTLLinearSolver, <span class="keyword">typename</span> BCRSMatrix&gt;</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="a02691.html">  519</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a02691.html">SolverHelper</a></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="a02691.html#ad262bc942bd8e5d74bd581eab94fe03f">  522</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a02691.html#ad262bc942bd8e5d74bd581eab94fe03f">setMatrix</a> (ISTLLinearSolver&amp; solver,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                           <span class="keyword">const</span> <a class="code" href="a01155.html">BCRSMatrix</a>&amp; matrix)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> is_direct_solver</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        = <a class="code" href="a02775.html">Dune::IsDirectSolver&lt;ISTLLinearSolver&gt;::value</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="a02691.html#ad262bc942bd8e5d74bd581eab94fe03f">SolverHelper&lt;ISTLLinearSolver,BCRSMatrix&gt;::</a></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<a class="code" href="a02691.html#ad262bc942bd8e5d74bd581eab94fe03f">        Implementation&lt;is_direct_solver&gt;::setMatrix</a>(solver,matrix);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> is_direct_solver, <span class="keyword">typename</span> Dummy = <span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="a02695.html">  537</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="a02695.html">Implementation</a></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    {</div>
<div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="a02695.html#a068af673ea1154bb50bcdb48f32afbf5">  539</a></span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a02695.html#a068af673ea1154bb50bcdb48f32afbf5">setMatrix</a> (ISTLLinearSolver&amp;,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                             <span class="keyword">const</span> <a class="code" href="a01155.html">BCRSMatrix</a>&amp;)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      {}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    };</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Dummy&gt;</div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="a02699.html">  549</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="a02695.html">Implementation</a>&lt;true,Dummy&gt;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    {</div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="a02699.html#a0a2fc5010b9b75a36d5394570bd5d756">  551</a></span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a02699.html#a0a2fc5010b9b75a36d5394570bd5d756">setMatrix</a> (ISTLLinearSolver&amp; solver,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                             <span class="keyword">const</span> <a class="code" href="a01155.html">BCRSMatrix</a>&amp; matrix)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        solver.setMatrix(matrix);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    };</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  };</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aa00104_html"><div class="ttname"><a href="a00104.html">operators.hh</a></div><div class="ttdoc">Define general, extensible interface for operators. The available implementation wraps a matrix.</div></div>
<div class="ttc" id="aa00179_html"><div class="ttname"><a href="a00179.html">preconditioner.hh</a></div></div>
<div class="ttc" id="aa00188_html"><div class="ttname"><a href="a00188.html">scalarproducts.hh</a></div><div class="ttdoc">Define base class for scalar product and norm.</div></div>
<div class="ttc" id="aa00212_html"><div class="ttname"><a href="a00212.html">solvertype.hh</a></div><div class="ttdoc">Templates characterizing the type of a solver.</div></div>
<div class="ttc" id="aa00252_html"><div class="ttname"><a href="a00252.html">Dune</a></div><div class="ttdef"><b>Definition:</b> allocator.hh:9</div></div>
<div class="ttc" id="aa00252_html_a405d30f54803def97082030c715c8791"><div class="ttname"><a href="a00252.html#a405d30f54803def97082030c715c8791">Dune::get</a></div><div class="ttdeci">PropertyMapTypeSelector&lt; Amg::VertexVisitedTag, Amg::PropertiesGraph&lt; G, Amg::VertexProperties, EP, VM, EM &gt; &gt;::Type get([[maybe_unused]] const Amg::VertexVisitedTag &amp;tag, Amg::PropertiesGraph&lt; G, Amg::VertexProperties, EP, VM, EM &gt; &amp;graph)</div><div class="ttdef"><b>Definition:</b> dependency.hh:291</div></div>
<div class="ttc" id="aa01155_html"><div class="ttname"><a href="a01155.html">Dune::BCRSMatrix</a></div><div class="ttdoc">A sparse block matrix with compressed row storage.</div><div class="ttdef"><b>Definition:</b> bcrsmatrix.hh:464</div></div>
<div class="ttc" id="aa01395_html"><div class="ttname"><a href="a01395.html">Dune::SolverAbort</a></div><div class="ttdoc">Thrown when a solver aborts due to some problem.</div><div class="ttdef"><b>Definition:</b> istlexception.hh:53</div></div>
<div class="ttc" id="aa01819_html"><div class="ttname"><a href="a01819.html">Dune::LinearOperator</a></div><div class="ttdoc">A linear operator.</div><div class="ttdef"><b>Definition:</b> operators.hh:65</div></div>
<div class="ttc" id="aa02583_html"><div class="ttname"><a href="a02583.html">Dune::Preconditioner</a></div><div class="ttdoc">Base class for matrix free definition of preconditioners.</div><div class="ttdef"><b>Definition:</b> preconditioner.hh:30</div></div>
<div class="ttc" id="aa02639_html"><div class="ttname"><a href="a02639.html">Dune::ScalarProduct</a></div><div class="ttdoc">Base class for scalar product and norm computation.</div><div class="ttdef"><b>Definition:</b> scalarproducts.hh:50</div></div>
<div class="ttc" id="aa02647_html"><div class="ttname"><a href="a02647.html">Dune::SeqScalarProduct</a></div><div class="ttdoc">Default implementation for the scalar case.</div><div class="ttdef"><b>Definition:</b> scalarproducts.hh:166</div></div>
<div class="ttc" id="aa02675_html"><div class="ttname"><a href="a02675.html">Dune::InverseOperatorResult</a></div><div class="ttdoc">Statistics about the application of an inverse operator.</div><div class="ttdef"><b>Definition:</b> solver.hh:46</div></div>
<div class="ttc" id="aa02675_html_a007457c192debe371ae62caa3db02127"><div class="ttname"><a href="a02675.html#a007457c192debe371ae62caa3db02127">Dune::InverseOperatorResult::InverseOperatorResult</a></div><div class="ttdeci">InverseOperatorResult()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> solver.hh:48</div></div>
<div class="ttc" id="aa02675_html_a53279693ec639d61538909b952ede7ab"><div class="ttname"><a href="a02675.html#a53279693ec639d61538909b952ede7ab">Dune::InverseOperatorResult::condition_estimate</a></div><div class="ttdeci">double condition_estimate</div><div class="ttdoc">Estimate of condition number.</div><div class="ttdef"><b>Definition:</b> solver.hh:77</div></div>
<div class="ttc" id="aa02675_html_a93d6c1ada77e3a99962bfdf94d4bdb9c"><div class="ttname"><a href="a02675.html#a93d6c1ada77e3a99962bfdf94d4bdb9c">Dune::InverseOperatorResult::elapsed</a></div><div class="ttdeci">double elapsed</div><div class="ttdoc">Elapsed time in seconds.</div><div class="ttdef"><b>Definition:</b> solver.hh:80</div></div>
<div class="ttc" id="aa02675_html_ac42bf46e67cf01e6eb29f2b05bdb9f42"><div class="ttname"><a href="a02675.html#ac42bf46e67cf01e6eb29f2b05bdb9f42">Dune::InverseOperatorResult::iterations</a></div><div class="ttdeci">int iterations</div><div class="ttdoc">Number of iterations.</div><div class="ttdef"><b>Definition:</b> solver.hh:65</div></div>
<div class="ttc" id="aa02675_html_ad6068f30dda791930ee16d4e9f3af353"><div class="ttname"><a href="a02675.html#ad6068f30dda791930ee16d4e9f3af353">Dune::InverseOperatorResult::reduction</a></div><div class="ttdeci">double reduction</div><div class="ttdoc">Reduction achieved: .</div><div class="ttdef"><b>Definition:</b> solver.hh:68</div></div>
<div class="ttc" id="aa02675_html_af6eb51e594a8cb7ab84cabd5e5743b77"><div class="ttname"><a href="a02675.html#af6eb51e594a8cb7ab84cabd5e5743b77">Dune::InverseOperatorResult::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Resets all data.</div><div class="ttdef"><b>Definition:</b> solver.hh:54</div></div>
<div class="ttc" id="aa02675_html_af8839098f24da4a9305b62adb1ad25fa"><div class="ttname"><a href="a02675.html#af8839098f24da4a9305b62adb1ad25fa">Dune::InverseOperatorResult::conv_rate</a></div><div class="ttdeci">double conv_rate</div><div class="ttdoc">Convergence rate (average reduction per step)</div><div class="ttdef"><b>Definition:</b> solver.hh:74</div></div>
<div class="ttc" id="aa02675_html_afefe366c3c36a5a9a599c2ba4c711ab6"><div class="ttname"><a href="a02675.html#afefe366c3c36a5a9a599c2ba4c711ab6">Dune::InverseOperatorResult::converged</a></div><div class="ttdeci">bool converged</div><div class="ttdoc">True if convergence criterion has been met.</div><div class="ttdef"><b>Definition:</b> solver.hh:71</div></div>
<div class="ttc" id="aa02679_html"><div class="ttname"><a href="a02679.html">Dune::InverseOperator</a></div><div class="ttdoc">Abstract base class for all solvers.</div><div class="ttdef"><b>Definition:</b> solver.hh:97</div></div>
<div class="ttc" id="aa02679_html_a07986680755603e2cc783f8be1994d1f"><div class="ttname"><a href="a02679.html#a07986680755603e2cc783f8be1994d1f">Dune::InverseOperator::printHeader</a></div><div class="ttdeci">void printHeader(std::ostream &amp;s) const</div><div class="ttdoc">helper function for printing header of solver output</div><div class="ttdef"><b>Definition:</b> solver.hh:161</div></div>
<div class="ttc" id="aa02679_html_a0c15f8be3b793a367af0b0cb324a942d"><div class="ttname"><a href="a02679.html#a0c15f8be3b793a367af0b0cb324a942d">Dune::InverseOperator::~InverseOperator</a></div><div class="ttdeci">virtual ~InverseOperator()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> solver.hh:154</div></div>
<div class="ttc" id="aa02679_html_a1c5876dba1ae3409f017e30cbd0a7838"><div class="ttname"><a href="a02679.html#a1c5876dba1ae3409f017e30cbd0a7838">Dune::InverseOperator::printOutput</a></div><div class="ttdeci">void printOutput(std::ostream &amp;s, const CountType &amp;iter, const DataType &amp;norm) const</div><div class="ttdoc">helper function for printing solver output</div><div class="ttdef"><b>Definition:</b> solver.hh:183</div></div>
<div class="ttc" id="aa02679_html_a45229eb4007296995264f4277a89b51c"><div class="ttname"><a href="a02679.html#a45229eb4007296995264f4277a89b51c">Dune::InverseOperator::printOutput</a></div><div class="ttdeci">void printOutput(std::ostream &amp;s, const CountType &amp;iter, const DataType &amp;norm, const DataType &amp;norm_old) const</div><div class="ttdoc">helper function for printing solver output</div><div class="ttdef"><b>Definition:</b> solver.hh:170</div></div>
<div class="ttc" id="aa02679_html_a57a25fc54525ae58726ec0f274d5cc29"><div class="ttname"><a href="a02679.html#a57a25fc54525ae58726ec0f274d5cc29">Dune::InverseOperator::apply</a></div><div class="ttdeci">virtual void apply(X &amp;x, Y &amp;b, double reduction, InverseOperatorResult &amp;res)=0</div><div class="ttdoc">apply inverse operator, with given convergence criteria.</div></div>
<div class="ttc" id="aa02679_html_a7ef8454657f69b2e69fcd9a2779cee4e"><div class="ttname"><a href="a02679.html#a7ef8454657f69b2e69fcd9a2779cee4e">Dune::InverseOperator::scalar_real_type</a></div><div class="ttdeci">Simd::Scalar&lt; real_type &gt; scalar_real_type</div><div class="ttdoc">scalar type underlying the field_type</div><div class="ttdef"><b>Definition:</b> solver.hh:112</div></div>
<div class="ttc" id="aa02679_html_a85b7df40fa5e6a60c2a3db25a4140823"><div class="ttname"><a href="a02679.html#a85b7df40fa5e6a60c2a3db25a4140823">Dune::InverseOperator::range_type</a></div><div class="ttdeci">Y range_type</div><div class="ttdoc">Type of the range of the operator to be inverted.</div><div class="ttdef"><b>Definition:</b> solver.hh:103</div></div>
<div class="ttc" id="aa02679_html_aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94"><div class="ttname"><a href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa3e7887a2fbc4f073d7c6dde204557d94">Dune::InverseOperator::normSpacing</a></div><div class="ttdeci">@ normSpacing</div><div class="ttdef"><b>Definition:</b> solver.hh:158</div></div>
<div class="ttc" id="aa02679_html_aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7"><div class="ttname"><a href="a02679.html#aa1dfd25631ab66c43480f464a732afcaa9fce7d3cb1a28247f8d0f8fe2d3863a7">Dune::InverseOperator::iterationSpacing</a></div><div class="ttdeci">@ iterationSpacing</div><div class="ttdef"><b>Definition:</b> solver.hh:158</div></div>
<div class="ttc" id="aa02679_html_aaba59848baa4879b548d96b9f77e150a"><div class="ttname"><a href="a02679.html#aaba59848baa4879b548d96b9f77e150a">Dune::InverseOperator::domain_type</a></div><div class="ttdeci">X domain_type</div><div class="ttdoc">Type of the domain of the operator to be inverted.</div><div class="ttdef"><b>Definition:</b> solver.hh:100</div></div>
<div class="ttc" id="aa02679_html_aaef4f0b84f4a983421f15b6eea8c69ab"><div class="ttname"><a href="a02679.html#aaef4f0b84f4a983421f15b6eea8c69ab">Dune::InverseOperator::apply</a></div><div class="ttdeci">virtual void apply(X &amp;x, Y &amp;b, InverseOperatorResult &amp;res)=0</div><div class="ttdoc">Apply inverse operator,.</div></div>
<div class="ttc" id="aa02679_html_adce5c3d7c39415d90326ccc06b94b9dc"><div class="ttname"><a href="a02679.html#adce5c3d7c39415d90326ccc06b94b9dc">Dune::InverseOperator::field_type</a></div><div class="ttdeci">X::field_type field_type</div><div class="ttdoc">The field type of the operator.</div><div class="ttdef"><b>Definition:</b> solver.hh:106</div></div>
<div class="ttc" id="aa02679_html_ae08de8ceccc057d0785cfda953796a81"><div class="ttname"><a href="a02679.html#ae08de8ceccc057d0785cfda953796a81">Dune::InverseOperator::real_type</a></div><div class="ttdeci">FieldTraits&lt; field_type &gt;::real_type real_type</div><div class="ttdoc">The real type of the field type (is the same if using real numbers, but differs for std::complex)</div><div class="ttdef"><b>Definition:</b> solver.hh:109</div></div>
<div class="ttc" id="aa02679_html_ae74604dd6afec05c0e2a080fe403d2a1"><div class="ttname"><a href="a02679.html#ae74604dd6afec05c0e2a080fe403d2a1">Dune::InverseOperator::category</a></div><div class="ttdeci">virtual SolverCategory::Category category() const =0</div><div class="ttdoc">Category of the solver (see SolverCategory::Category)</div></div>
<div class="ttc" id="aa02683_html"><div class="ttname"><a href="a02683.html">Dune::IterativeSolver</a></div><div class="ttdoc">Base class for all implementations of iterative solvers.</div><div class="ttdef"><b>Definition:</b> solver.hh:201</div></div>
<div class="ttc" id="aa02683_html_a2e5c17e2cf1c34f2ff6c696d551c3acb"><div class="ttname"><a href="a02683.html#a2e5c17e2cf1c34f2ff6c696d551c3acb">Dune::IterativeSolver::IterativeSolver</a></div><div class="ttdeci">IterativeSolver(LinearOperator&lt; X, Y &gt; &amp;op, ScalarProduct&lt; X &gt; &amp;sp, Preconditioner&lt; X, Y &gt; &amp;prec, scalar_real_type reduction, int maxit, int verbose)</div><div class="ttdoc">General constructor to initialize an iterative solver.</div><div class="ttdef"><b>Definition:</b> solver.hh:260</div></div>
<div class="ttc" id="aa02683_html_a42273cb037e81940486a2109adf4a941"><div class="ttname"><a href="a02683.html#a42273cb037e81940486a2109adf4a941">Dune::IterativeSolver::apply</a></div><div class="ttdeci">virtual void apply(X &amp;x, X &amp;b, double reduction, InverseOperatorResult &amp;res)</div><div class="ttdoc">Apply inverse operator with given reduction factor.</div><div class="ttdef"><b>Definition:</b> solver.hh:372</div></div>
<div class="ttc" id="aa02683_html_a7a15e3a8451ca039a01251e25dad47c2"><div class="ttname"><a href="a02683.html#a7a15e3a8451ca039a01251e25dad47c2">Dune::IterativeSolver::name</a></div><div class="ttdeci">std::string name() const</div><div class="ttdef"><b>Definition:</b> solver.hh:386</div></div>
<div class="ttc" id="aa02683_html_a94e87f284efd1ea398108ac23f77bda1"><div class="ttname"><a href="a02683.html#a94e87f284efd1ea398108ac23f77bda1">Dune::IterativeSolver::_op</a></div><div class="ttdeci">std::shared_ptr&lt; LinearOperator&lt; X, Y &gt; &gt; _op</div><div class="ttdef"><b>Definition:</b> solver.hh:502</div></div>
<div class="ttc" id="aa02683_html_a9591f7951c8d340cda51ad6093ac9c12"><div class="ttname"><a href="a02683.html#a9591f7951c8d340cda51ad6093ac9c12">Dune::IterativeSolver::IterativeSolver</a></div><div class="ttdeci">IterativeSolver(std::shared_ptr&lt; LinearOperator&lt; X, Y &gt;&gt; op, std::shared_ptr&lt; ScalarProduct&lt; X &gt;&gt; sp, std::shared_ptr&lt; Preconditioner&lt; X, Y &gt;&gt; prec, scalar_real_type reduction, int maxit, int verbose)</div><div class="ttdoc">General constructor to initialize an iterative solver.</div><div class="ttdef"><b>Definition:</b> solver.hh:338</div></div>
<div class="ttc" id="aa02683_html_a95d46723a40e4e699102cf1dc96c7713"><div class="ttname"><a href="a02683.html#a95d46723a40e4e699102cf1dc96c7713">Dune::IterativeSolver::_sp</a></div><div class="ttdeci">std::shared_ptr&lt; ScalarProduct&lt; X &gt; &gt; _sp</div><div class="ttdef"><b>Definition:</b> solver.hh:504</div></div>
<div class="ttc" id="aa02683_html_a95ff9476da2017980a0574aa0c3d3048"><div class="ttname"><a href="a02683.html#a95ff9476da2017980a0574aa0c3d3048">Dune::IterativeSolver::IterativeSolver</a></div><div class="ttdeci">IterativeSolver(std::shared_ptr&lt; LinearOperator&lt; X, Y &gt; &gt; op, std::shared_ptr&lt; Preconditioner&lt; X, X &gt; &gt; prec, const ParameterTree &amp;configuration)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> solver.hh:288</div></div>
<div class="ttc" id="aa02683_html_a9b9fc491826e83b4b56e9d9354e07155"><div class="ttname"><a href="a02683.html#a9b9fc491826e83b4b56e9d9354e07155">Dune::IterativeSolver::_maxit</a></div><div class="ttdeci">int _maxit</div><div class="ttdef"><b>Definition:</b> solver.hh:506</div></div>
<div class="ttc" id="aa02683_html_aa3aac0420d78c7e981855173998dfdbd"><div class="ttname"><a href="a02683.html#aa3aac0420d78c7e981855173998dfdbd">Dune::IterativeSolver::IterativeSolver</a></div><div class="ttdeci">IterativeSolver(LinearOperator&lt; X, Y &gt; &amp;op, Preconditioner&lt; X, Y &gt; &amp;prec, scalar_real_type reduction, int maxit, int verbose)</div><div class="ttdoc">General constructor to initialize an iterative solver.</div><div class="ttdef"><b>Definition:</b> solver.hh:228</div></div>
<div class="ttc" id="aa02683_html_aafd5c0f9fb28cea306a95fa326f197df"><div class="ttname"><a href="a02683.html#aafd5c0f9fb28cea306a95fa326f197df">Dune::IterativeSolver::_verbose</a></div><div class="ttdeci">int _verbose</div><div class="ttdef"><b>Definition:</b> solver.hh:507</div></div>
<div class="ttc" id="aa02683_html_ac9fa53fbc7b256e48620dd8acfbcac0a"><div class="ttname"><a href="a02683.html#ac9fa53fbc7b256e48620dd8acfbcac0a">Dune::IterativeSolver::_reduction</a></div><div class="ttdeci">scalar_real_type _reduction</div><div class="ttdef"><b>Definition:</b> solver.hh:505</div></div>
<div class="ttc" id="aa02683_html_ae86a07e35fee34640932781b5f0b57e8"><div class="ttname"><a href="a02683.html#ae86a07e35fee34640932781b5f0b57e8">Dune::IterativeSolver::_category</a></div><div class="ttdeci">SolverCategory::Category _category</div><div class="ttdef"><b>Definition:</b> solver.hh:508</div></div>
<div class="ttc" id="aa02683_html_af2fa55775d41709b976bfa306d8cd50e"><div class="ttname"><a href="a02683.html#af2fa55775d41709b976bfa306d8cd50e">Dune::IterativeSolver::IterativeSolver</a></div><div class="ttdeci">IterativeSolver(std::shared_ptr&lt; LinearOperator&lt; X, Y &gt; &gt; op, std::shared_ptr&lt; ScalarProduct&lt; X &gt; &gt; sp, std::shared_ptr&lt; Preconditioner&lt; X, X &gt; &gt; prec, const ParameterTree &amp;configuration)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> solver.hh:311</div></div>
<div class="ttc" id="aa02683_html_af4a8a49af428c01332ca8254f124de3e"><div class="ttname"><a href="a02683.html#af4a8a49af428c01332ca8254f124de3e">Dune::IterativeSolver::_prec</a></div><div class="ttdeci">std::shared_ptr&lt; Preconditioner&lt; X, Y &gt; &gt; _prec</div><div class="ttdef"><b>Definition:</b> solver.hh:503</div></div>
<div class="ttc" id="aa02683_html_af4e81a96530540ab4040226ad3346c51"><div class="ttname"><a href="a02683.html#af4e81a96530540ab4040226ad3346c51">Dune::IterativeSolver::category</a></div><div class="ttdeci">virtual SolverCategory::Category category() const</div><div class="ttdoc">Category of the solver (see SolverCategory::Category)</div><div class="ttdef"><b>Definition:</b> solver.hh:381</div></div>
<div class="ttc" id="aa02687_html"><div class="ttname"><a href="a02687.html">Dune::IterativeSolver::Iteration</a></div><div class="ttdoc">Class for controlling iterative methods.</div><div class="ttdef"><b>Definition:</b> solver.hh:409</div></div>
<div class="ttc" id="aa02687_html_a01db9f251b305695f6ede7edae579970"><div class="ttname"><a href="a02687.html#a01db9f251b305695f6ede7edae579970">Dune::IterativeSolver::Iteration::Iteration</a></div><div class="ttdeci">Iteration(const IterativeSolver &amp;parent, InverseOperatorResult &amp;res)</div><div class="ttdef"><b>Definition:</b> solver.hh:411</div></div>
<div class="ttc" id="aa02687_html_a0870995022d0c5e1cee1f1b8fa84d6cd"><div class="ttname"><a href="a02687.html#a0870995022d0c5e1cee1f1b8fa84d6cd">Dune::IterativeSolver::Iteration::Iteration</a></div><div class="ttdeci">Iteration(Iteration &amp;&amp;other)</div><div class="ttdef"><b>Definition:</b> solver.hh:426</div></div>
<div class="ttc" id="aa02687_html_a578b54e82b28dd193ff20dcd463b63ed"><div class="ttname"><a href="a02687.html#a578b54e82b28dd193ff20dcd463b63ed">Dune::IterativeSolver::Iteration::_res</a></div><div class="ttdeci">InverseOperatorResult &amp; _res</div><div class="ttdef"><b>Definition:</b> solver.hh:496</div></div>
<div class="ttc" id="aa02687_html_a6feea72dd4985c4ea2c75d3768d43dc1"><div class="ttname"><a href="a02687.html#a6feea72dd4985c4ea2c75d3768d43dc1">Dune::IterativeSolver::Iteration::_parent</a></div><div class="ttdeci">const IterativeSolver &amp; _parent</div><div class="ttdef"><b>Definition:</b> solver.hh:497</div></div>
<div class="ttc" id="aa02687_html_a72944218d9cc08701a763b3fa4e7cc08"><div class="ttname"><a href="a02687.html#a72944218d9cc08701a763b3fa4e7cc08">Dune::IterativeSolver::Iteration::_watch</a></div><div class="ttdeci">Timer _watch</div><div class="ttdef"><b>Definition:</b> solver.hh:495</div></div>
<div class="ttc" id="aa02687_html_a84153f8c63471c148532d3bcddcce54b"><div class="ttname"><a href="a02687.html#a84153f8c63471c148532d3bcddcce54b">Dune::IterativeSolver::Iteration::Iteration</a></div><div class="ttdeci">Iteration(const Iteration &amp;)=delete</div></div>
<div class="ttc" id="aa02687_html_a9bab7086c42d975f942b6c8babd0c5cd"><div class="ttname"><a href="a02687.html#a9bab7086c42d975f942b6c8babd0c5cd">Dune::IterativeSolver::Iteration::_i</a></div><div class="ttdeci">CountType _i</div><div class="ttdef"><b>Definition:</b> solver.hh:494</div></div>
<div class="ttc" id="aa02687_html_ab225834a68c68d6289badd96f4e783e0"><div class="ttname"><a href="a02687.html#ab225834a68c68d6289badd96f4e783e0">Dune::IterativeSolver::Iteration::_def0</a></div><div class="ttdeci">real_type _def0</div><div class="ttdef"><b>Definition:</b> solver.hh:493</div></div>
<div class="ttc" id="aa02687_html_ac6ab252966c7aff8bcd672ea58d0361a"><div class="ttname"><a href="a02687.html#ac6ab252966c7aff8bcd672ea58d0361a">Dune::IterativeSolver::Iteration::step</a></div><div class="ttdeci">bool step(CountType i, real_type def)</div><div class="ttdoc">registers the iteration step, checks for invalid defect norm and convergence.</div><div class="ttdef"><b>Definition:</b> solver.hh:453</div></div>
<div class="ttc" id="aa02687_html_adb9ada3a3a9fa9b0e6d5955f4e17d04e"><div class="ttname"><a href="a02687.html#adb9ada3a3a9fa9b0e6d5955f4e17d04e">Dune::IterativeSolver::Iteration::finalize</a></div><div class="ttdeci">void finalize()</div><div class="ttdef"><b>Definition:</b> solver.hh:478</div></div>
<div class="ttc" id="aa02687_html_ae2d5ee5ea1ac1747063687427b21b554"><div class="ttname"><a href="a02687.html#ae2d5ee5ea1ac1747063687427b21b554">Dune::IterativeSolver::Iteration::_def</a></div><div class="ttdeci">real_type _def</div><div class="ttdef"><b>Definition:</b> solver.hh:493</div></div>
<div class="ttc" id="aa02687_html_ae5a464a44d3df1b30f1452a7e313d2c2"><div class="ttname"><a href="a02687.html#ae5a464a44d3df1b30f1452a7e313d2c2">Dune::IterativeSolver::Iteration::~Iteration</a></div><div class="ttdeci">~Iteration()</div><div class="ttdef"><b>Definition:</b> solver.hh:438</div></div>
<div class="ttc" id="aa02687_html_aef0d0c1da2cb0516ee561856025f5888"><div class="ttname"><a href="a02687.html#aef0d0c1da2cb0516ee561856025f5888">Dune::IterativeSolver::Iteration::_valid</a></div><div class="ttdeci">bool _valid</div><div class="ttdef"><b>Definition:</b> solver.hh:498</div></div>
<div class="ttc" id="aa02691_html"><div class="ttname"><a href="a02691.html">Dune::SolverHelper</a></div><div class="ttdoc">Helper class for notifying a DUNE-ISTL linear solver about a change of the iteration matrix object in...</div><div class="ttdef"><b>Definition:</b> solver.hh:520</div></div>
<div class="ttc" id="aa02691_html_ad262bc942bd8e5d74bd581eab94fe03f"><div class="ttname"><a href="a02691.html#ad262bc942bd8e5d74bd581eab94fe03f">Dune::SolverHelper::setMatrix</a></div><div class="ttdeci">static void setMatrix(ISTLLinearSolver &amp;solver, const BCRSMatrix &amp;matrix)</div><div class="ttdef"><b>Definition:</b> solver.hh:522</div></div>
<div class="ttc" id="aa02695_html"><div class="ttname"><a href="a02695.html">Dune::SolverHelper::Implementation</a></div><div class="ttdoc">Implementation that works together with iterative ISTL solvers, e.g. Dune::CGSolver or Dune::BiCGSTAB...</div><div class="ttdef"><b>Definition:</b> solver.hh:538</div></div>
<div class="ttc" id="aa02695_html_a068af673ea1154bb50bcdb48f32afbf5"><div class="ttname"><a href="a02695.html#a068af673ea1154bb50bcdb48f32afbf5">Dune::SolverHelper::Implementation::setMatrix</a></div><div class="ttdeci">static void setMatrix(ISTLLinearSolver &amp;, const BCRSMatrix &amp;)</div><div class="ttdef"><b>Definition:</b> solver.hh:539</div></div>
<div class="ttc" id="aa02699_html_a0a2fc5010b9b75a36d5394570bd5d756"><div class="ttname"><a href="a02699.html#a0a2fc5010b9b75a36d5394570bd5d756">Dune::SolverHelper::Implementation&lt; true, Dummy &gt;::setMatrix</a></div><div class="ttdeci">static void setMatrix(ISTLLinearSolver &amp;solver, const BCRSMatrix &amp;matrix)</div><div class="ttdef"><b>Definition:</b> solver.hh:551</div></div>
<div class="ttc" id="aa02703_html"><div class="ttname"><a href="a02703.html">Dune::SolverCategory</a></div><div class="ttdoc">Categories for the solvers.</div><div class="ttdef"><b>Definition:</b> solvercategory.hh:20</div></div>
<div class="ttc" id="aa02703_html_ae061380ac961490be6ee353cf0dc1733"><div class="ttname"><a href="a02703.html#ae061380ac961490be6ee353cf0dc1733">Dune::SolverCategory::Category</a></div><div class="ttdeci">Category</div><div class="ttdef"><b>Definition:</b> solvercategory.hh:21</div></div>
<div class="ttc" id="aa02703_html_ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9"><div class="ttname"><a href="a02703.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9">Dune::SolverCategory::sequential</a></div><div class="ttdeci">@ sequential</div><div class="ttdoc">Category for sequential solvers.</div><div class="ttdef"><b>Definition:</b> solvercategory.hh:23</div></div>
<div class="ttc" id="aa02703_html_ae4e4556d105b5ee100a3f57921845cc4"><div class="ttname"><a href="a02703.html#ae4e4556d105b5ee100a3f57921845cc4">Dune::SolverCategory::category</a></div><div class="ttdeci">static Category category(const OP &amp;op, decltype(op.category()) *=nullptr)</div><div class="ttdoc">Helperfunction to extract the solver category either from an enum, or from the newly introduced virtu...</div><div class="ttdef"><b>Definition:</b> solvercategory.hh:32</div></div>
<div class="ttc" id="aa02707_html"><div class="ttname"><a href="a02707.html">Dune::InvalidSolverCategory</a></div><div class="ttdef"><b>Definition:</b> solvercategory.hh:52</div></div>
<div class="ttc" id="aa02775_html"><div class="ttname"><a href="a02775.html">Dune::IsDirectSolver</a></div><div class="ttdef"><b>Definition:</b> solvertype.hh:14</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
