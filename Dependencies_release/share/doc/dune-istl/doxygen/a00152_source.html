<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dune-istl: kamg.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dune-istl
   &#160;<span id="projectnumber">2.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b8b565de3f42c43d20f21e2cb1a39db5.html">dune-istl</a></li><li class="navelem"><a class="el" href="dir_0db5ea851c640d2cb3de351510d7ca77.html">dune</a></li><li class="navelem"><a class="el" href="dir_076cadbab1aab890d8de2944aa4b23a3.html">istl</a></li><li class="navelem"><a class="el" href="dir_a1c4df73e8bd674fa1c62df83d31f70e.html">paamg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">kamg.hh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00152.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// vi: set et ts=4 sw=2 sts=2:</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifndef DUNE_AMG_KAMG_HH</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#define DUNE_AMG_KAMG_HH</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00182.html">dune/istl/preconditioners.hh</a>&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00116.html">amg.hh</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">namespace </span><a class="code" href="a00252.html">Dune</a></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keyword">namespace </span>Amg</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> AMG&gt;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="a02075.html">   29</a></span>&#160;    <span class="keyword">class </span><a class="code" href="a02075.html">KAmgTwoGrid</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      : <span class="keyword">public</span> <a class="code" href="a02583.html">Preconditioner</a>&lt;typename AMG::Domain,typename AMG::Range&gt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">AMG::Domain</a> Domain;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">AMG::Range</a> Range;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="a02075.html#a8a97df5c3ceb629a4dce6c7258795ed8">   39</a></span>&#160;      <span class="keyword">virtual</span> <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733">SolverCategory::Category</a> <a class="code" href="a02075.html#a8a97df5c3ceb629a4dce6c7258795ed8">category</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">      </span>{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> amg_.<a class="code" href="a00243.html#gaf332edc0dc7fcd54a1238811e67f2f29">category</a>();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      };</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="a02075.html#a13d3da72f282e04f2fbbb8e6ee7a4724">   51</a></span>&#160;      <a class="code" href="a02075.html#a13d3da72f282e04f2fbbb8e6ee7a4724">KAmgTwoGrid</a>(<a class="code" href="a02079.html">AMG</a>&amp; amg, std::shared_ptr&lt;<a class="code" href="a02679.html">InverseOperator&lt;Domain,Range&gt;</a> &gt; <a class="code" href="a02075.html#a13659ea8197676a196736be881452f2d">coarseSolver</a>)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        : amg_(amg), coarseSolver_(<a class="code" href="a02075.html#a13659ea8197676a196736be881452f2d">coarseSolver</a>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      {}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="a02075.html#a91b79c8509792c0f2a022cff6936b757">   56</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a02075.html#a91b79c8509792c0f2a022cff6936b757">pre</a>([[maybe_unused]] <span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">AMG::Domain</a>&amp; x, [[maybe_unused]] <span class="keyword">typename</span> <a class="code" href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">AMG::Range</a>&amp; b)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      {}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="a02075.html#aa216ed44cd677a5332cfb977864ba431">   60</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a02075.html#aa216ed44cd677a5332cfb977864ba431">post</a>([[maybe_unused]] <span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">AMG::Domain</a>&amp; x)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      {}</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="a02075.html#ae7e5b82e07f49643b683c0125ad453eb">   64</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a02075.html#ae7e5b82e07f49643b683c0125ad453eb">apply</a>(<span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">AMG::Domain</a>&amp; v, <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">AMG::Range</a>&amp; d)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Copy data</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        *levelContext_-&gt;update=0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        *levelContext_-&gt;rhs = d;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        *levelContext_-&gt;lhs = v;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="a00243.html#ga7c53f44b3b6ff7f8ccf90503bc995e11">presmooth</a>(*levelContext_, amg_.preSteps_);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">bool</span> processFineLevel =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          amg_.moveToCoarseLevel(*levelContext_);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span>(processFineLevel) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keyword">typename</span> <a class="code" href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">AMG::Range</a> b=*levelContext_-&gt;rhs;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">AMG::Domain</a> x=*levelContext_-&gt;update;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <a class="code" href="a02675.html">InverseOperatorResult</a> res;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          coarseSolver_-&gt;apply(x, b, res);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          *levelContext_-&gt;update=x;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        amg_.moveToFineLevel(*levelContext_, processFineLevel);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="a00243.html#gac8448b6118691fd94bc14d2126496c40">postsmooth</a>(*levelContext_, amg_.postSteps_);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        v=*levelContext_-&gt;update;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="a02075.html#a13659ea8197676a196736be881452f2d">   93</a></span>&#160;      <a class="code" href="a02679.html">InverseOperator&lt;Domain,Range&gt;</a>* <a class="code" href="a02075.html#a13659ea8197676a196736be881452f2d">coarseSolver</a>()</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> coarseSolver_;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="a02075.html#a8d82e681993d250da80a5499ed23513e">  102</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a02075.html#a8d82e681993d250da80a5499ed23513e">setLevelContext</a>(std::shared_ptr&lt;typename AMG::LevelContext&gt; p)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        levelContext_=p;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="a02075.html#a3a7a6e83e9bec4135ae952799b5efcc2">  108</a></span>&#160;      <a class="code" href="a02075.html#a3a7a6e83e9bec4135ae952799b5efcc2">~KAmgTwoGrid</a>()</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      {}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="a02079.html">AMG</a>&amp; amg_;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      std::shared_ptr&lt;InverseOperator&lt;Domain,Range&gt; &gt; coarseSolver_;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      std::shared_ptr&lt;typename AMG::LevelContext&gt; levelContext_;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    };</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class </span>M, <span class="keyword">class </span>X, <span class="keyword">class </span>S, <span class="keyword">class </span>PI=SequentialInformation,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">class </span>K=<a class="code" href="a02763.html">GeneralizedPCGSolver&lt;X&gt;</a>, <span class="keyword">class </span>A=std::allocator&lt;X&gt; &gt;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="a02071.html">  137</a></span>&#160;    <span class="keyword">class </span><a class="code" href="a02071.html">KAMG</a> : <span class="keyword">public</span> <a class="code" href="a02583.html">Preconditioner</a>&lt;X,X&gt;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="a02071.html#aadb12fe2c19323e23aeddf5032ade422">  141</a></span>&#160;      <span class="keyword">typedef</span> <a class="code" href="a02079.html">AMG&lt;M,X,S,PI,A&gt;</a> <a class="code" href="a02071.html#aadb12fe2c19323e23aeddf5032ade422">Amg</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="a02071.html#ad67f4d58267ba57613310741f6701b2f">  143</a></span>&#160;      <span class="keyword">typedef</span> K <a class="code" href="a02071.html#ad67f4d58267ba57613310741f6701b2f">KrylovSolver</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="a02071.html#a7e3413154b8e7cbf122dfd9fcc35bec3">  145</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a02375.html">Amg::OperatorHierarchy</a> <a class="code" href="a02071.html#a7e3413154b8e7cbf122dfd9fcc35bec3">OperatorHierarchy</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="a02071.html#a201cf0811a621236cfaa90f7ab96178b">  147</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a02679.html">Amg::CoarseSolver</a> <a class="code" href="a02071.html#a201cf0811a621236cfaa90f7ab96178b">CoarseSolver</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">  149</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#gafc3d32c625bd4cabd2481107019b2fb2">Amg::ParallelInformation</a> <a class="code" href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">ParallelInformation</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="a02071.html#a0c5423c11195465307c453ca3c476cde">  151</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga4b093095df84e9990eff5581cfe4bfa9">Amg::SmootherArgs</a> <a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="a02071.html#ab39ce79e42d2c9459c0824a9c64bd596">  153</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga66dc78b3214f4ebfc19c8ba3d467d25b">Amg::Operator</a> <a class="code" href="a02071.html#ab39ce79e42d2c9459c0824a9c64bd596">Operator</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="a02071.html#a0827421e95230dd79b1964820f5a5188">  155</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga2baddcf013a5166a162950672bd21a03">Amg::Domain</a> <a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">  157</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">Amg::Range</a> <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="a02071.html#ab715d269102c8e3cdabc81e0cf11527c">  159</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a02343.html">Amg::ParallelInformationHierarchy</a> <a class="code" href="a02071.html#ab715d269102c8e3cdabc81e0cf11527c">ParallelInformationHierarchy</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="a02071.html#a9496d834c44a3fb08400f1e2be9915f7">  161</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a02639.html">Amg::ScalarProduct</a> <a class="code" href="a02071.html#a9496d834c44a3fb08400f1e2be9915f7">ScalarProduct</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="a02071.html#ad470b061a6d4ce3366da6115827645e1">  164</a></span>&#160;      <span class="keyword">virtual</span> <a class="code" href="a02703.html#ae061380ac961490be6ee353cf0dc1733">SolverCategory::Category</a> <a class="code" href="a02071.html#ad470b061a6d4ce3366da6115827645e1">category</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">      </span>{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">return</span> amg.<a class="code" href="a00243.html#gaf332edc0dc7fcd54a1238811e67f2f29">category</a>();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      };</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">KAMG</a>(<a class="code" href="a02071.html#a7e3413154b8e7cbf122dfd9fcc35bec3">OperatorHierarchy</a>&amp; matrices, <a class="code" href="a02071.html#a201cf0811a621236cfaa90f7ab96178b">CoarseSolver</a>&amp; coarseSolver,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;           <span class="keyword">const</span> <a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>&amp; smootherArgs, <span class="keyword">const</span> <a class="code" href="a02407.html">Parameters</a>&amp; parms,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           std::size_t maxLevelKrylovSteps=3, <span class="keywordtype">double</span> minDefectReduction=1e-1);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">class</span> C&gt;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <a class="code" href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">KAMG</a>(<span class="keyword">const</span> <a class="code" href="a02071.html#ab39ce79e42d2c9459c0824a9c64bd596">Operator</a>&amp; fineOperator, <span class="keyword">const</span> C&amp; criterion,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;           <span class="keyword">const</span> <a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>&amp; smootherArgs=<a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>(),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;           std::size_t maxLevelKrylovSteps=3, <span class="keywordtype">double</span> minDefectReduction=1e-1,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;           <span class="keyword">const</span> <a class="code" href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">ParallelInformation</a>&amp; pinfo=<a class="code" href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">ParallelInformation</a>());</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00243.html#gaef3e58cdeac191a467f4a8c9cc39ebf4">pre</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; x, <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a>&amp; b);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00243.html#ga6dfeef8a854c652e39412a24679055bd">post</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; x);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00243.html#ga15d0a529de8f78321953fef8dd88d4f6">apply</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; v, <span class="keyword">const</span> <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a>&amp; d);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      std::size_t <a class="code" href="a00243.html#ga4a070cc7bc87f8600931736042a42fe9">maxlevels</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="a02071.html#aadb12fe2c19323e23aeddf5032ade422">Amg</a> amg;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      std::size_t maxLevelKrylovSteps;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">double</span> levelDefectReduction;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      std::vector&lt;std::shared_ptr&lt;typename Amg::ScalarProduct&gt; &gt; scalarproducts;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      std::vector&lt;std::shared_ptr&lt;KAmgTwoGrid&lt;Amg&gt; &gt; &gt; ksolvers;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    };</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">  231</a></span>&#160;    <a class="code" href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">KAMG&lt;M,X,S,P,K,A&gt;::KAMG</a>(<a class="code" href="a02375.html">OperatorHierarchy</a>&amp; matrices, <a class="code" href="a02679.html">CoarseSolver</a>&amp; coarseSolver,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                            <span class="keyword">const</span> <a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>&amp; smootherArgs, <span class="keyword">const</span> <a class="code" href="a02407.html">Parameters</a>&amp; params,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                            std::size_t ksteps, <span class="keywordtype">double</span> reduction)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      : amg(matrices, coarseSolver, smootherArgs, params),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        maxLevelKrylovSteps(ksteps), levelDefectReduction(reduction)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {}</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> C&gt;</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="a00243.html#gad6407508988b509f32cab6cb6f85fed1">  241</a></span>&#160;    <a class="code" href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">KAMG&lt;M,X,S,P,K,A&gt;::KAMG</a>(<span class="keyword">const</span> <a class="code" href="a02071.html#ab39ce79e42d2c9459c0824a9c64bd596">Operator</a>&amp; fineOperator, <span class="keyword">const</span> C&amp; criterion,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                            <span class="keyword">const</span> <a class="code" href="a02071.html#a0c5423c11195465307c453ca3c476cde">SmootherArgs</a>&amp; smootherArgs,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                            std::size_t ksteps, <span class="keywordtype">double</span> reduction,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                            <span class="keyword">const</span> <a class="code" href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">ParallelInformation</a>&amp; pinfo)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      : amg(fineOperator, criterion, smootherArgs, pinfo),</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        maxLevelKrylovSteps(ksteps), levelDefectReduction(reduction)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="a00243.html#gaef3e58cdeac191a467f4a8c9cc39ebf4">  251</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00243.html#gaef3e58cdeac191a467f4a8c9cc39ebf4">KAMG&lt;M,X,S,P,K,A&gt;::pre</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; x, <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a>&amp; b)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      amg.pre(x,b);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      scalarproducts.reserve(amg.levels());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      ksolvers.reserve(amg.levels());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keyword">typename</span> OperatorHierarchy::ParallelMatrixHierarchy::Iterator</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      matrix = amg.matrices_-&gt;matrices().coarsest();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keyword">typename</span> <a class="code" href="a02343.html#a4b48b3288872cb8bccef3b78f287e527">ParallelInformationHierarchy::Iterator</a></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      pinfo = amg.matrices_-&gt;parallelInformation().coarsest();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordtype">bool</span> hasCoarsest=(amg.levels()==amg.maxlevels());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">if</span>(hasCoarsest) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span>(matrix==amg.matrices_-&gt;matrices().finest())</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        --matrix;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        --pinfo;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        ksolvers.push_back(std::shared_ptr&lt;<a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a>(amg, amg.solver_)));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        ksolvers.push_back(std::shared_ptr&lt;<a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a>(amg, std::shared_ptr&lt;<a class="code" href="a02679.html">InverseOperator&lt;Domain,Range&gt;</a> &gt;())));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      std::ostringstream s;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">if</span>(matrix!=amg.matrices_-&gt;matrices().finest())</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          scalarproducts.push_back(createScalarProduct&lt;X&gt;(*pinfo,category()));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          std::shared_ptr&lt;InverseOperator&lt;Domain,Range&gt; &gt; ks =</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            std::shared_ptr&lt;InverseOperator&lt;Domain,Range&gt; &gt;(<span class="keyword">new</span> <a class="code" href="a02071.html#ad67f4d58267ba57613310741f6701b2f">KrylovSolver</a>(*matrix, *(scalarproducts.back()),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                                        *(ksolvers.back()), levelDefectReduction,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                                        maxLevelKrylovSteps, 0));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          ksolvers.push_back(std::shared_ptr&lt;<a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="a02075.html">KAmgTwoGrid&lt;Amg&gt;</a>(amg, ks)));</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          --matrix;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          --pinfo;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <span class="keywordflow">if</span>(matrix==amg.matrices_-&gt;matrices().finest())</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="a00243.html#ga6dfeef8a854c652e39412a24679055bd">  291</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00243.html#ga6dfeef8a854c652e39412a24679055bd">KAMG&lt;M,X,S,P,K,A&gt;::post</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; x)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      amg.post(x);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="a00243.html#ga15d0a529de8f78321953fef8dd88d4f6">  298</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00243.html#ga15d0a529de8f78321953fef8dd88d4f6">KAMG&lt;M,X,S,P,K,A&gt;::apply</a>(<a class="code" href="a02071.html#a0827421e95230dd79b1964820f5a5188">Domain</a>&amp; v, <span class="keyword">const</span> <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a>&amp; d)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span>(ksolvers.size()==0)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Range</a> td=d;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="a02675.html">InverseOperatorResult</a> res;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        amg.solver_-&gt;apply(v,td,res);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">typedef</span> <span class="keyword">typename</span> Amg::LevelContext LevelContext;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        std::shared_ptr&lt;LevelContext&gt; levelContext(<span class="keyword">new</span> LevelContext);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        amg.initIteratorsWithFineLevel(*levelContext);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">typedef</span> <span class="keyword">typename</span> std::vector&lt;std::shared_ptr&lt;KAmgTwoGrid&lt;Amg&gt; &gt; &gt;::iterator Iter;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span>(Iter solver=ksolvers.begin(); solver!=ksolvers.end(); ++solver)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          (*solver)-&gt;setLevelContext(levelContext);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        ksolvers.back()-&gt;apply(v,d);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> S, <span class="keyword">class</span> P, <span class="keyword">class</span> K, <span class="keyword">class</span> A&gt;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="a00243.html#ga4a070cc7bc87f8600931736042a42fe9">  318</a></span>&#160;    std::size_t <a class="code" href="a00243.html#ga4a070cc7bc87f8600931736042a42fe9">KAMG&lt;M,X,S,P,K,A&gt;::maxlevels</a>()</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">return</span> amg.maxlevels();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  } <span class="comment">// Amg</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;} <span class="comment">// Dune</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aa00116_html"><div class="ttname"><a href="a00116.html">amg.hh</a></div><div class="ttdoc">The AMG preconditioner.</div></div>
<div class="ttc" id="aa00182_html"><div class="ttname"><a href="a00182.html">preconditioners.hh</a></div><div class="ttdoc">Define general preconditioner interface.</div></div>
<div class="ttc" id="aa00243_html_ga15d0a529de8f78321953fef8dd88d4f6"><div class="ttname"><a href="a00243.html#ga15d0a529de8f78321953fef8dd88d4f6">Dune::Amg::KAMG::apply</a></div><div class="ttdeci">void apply(Domain &amp;v, const Range &amp;d)</div><div class="ttdoc">Apply one step of the preconditioner to the system A(v)=d.</div><div class="ttdef"><b>Definition:</b> kamg.hh:298</div></div>
<div class="ttc" id="aa00243_html_ga2baddcf013a5166a162950672bd21a03"><div class="ttname"><a href="a00243.html#ga2baddcf013a5166a162950672bd21a03">Dune::Amg::AMG::Domain</a></div><div class="ttdeci">X Domain</div><div class="ttdoc">The domain type.</div><div class="ttdef"><b>Definition:</b> amg.hh:85</div></div>
<div class="ttc" id="aa00243_html_ga3923d2f4d4d9b8fda692da71210ddb0a"><div class="ttname"><a href="a00243.html#ga3923d2f4d4d9b8fda692da71210ddb0a">Dune::Amg::KAMG::KAMG</a></div><div class="ttdeci">KAMG(OperatorHierarchy &amp;matrices, CoarseSolver &amp;coarseSolver, const SmootherArgs &amp;smootherArgs, const Parameters &amp;parms, std::size_t maxLevelKrylovSteps=3, double minDefectReduction=1e-1)</div><div class="ttdoc">Construct a new amg with a specific coarse solver.</div><div class="ttdef"><b>Definition:</b> kamg.hh:231</div></div>
<div class="ttc" id="aa00243_html_ga4a070cc7bc87f8600931736042a42fe9"><div class="ttname"><a href="a00243.html#ga4a070cc7bc87f8600931736042a42fe9">Dune::Amg::KAMG::maxlevels</a></div><div class="ttdeci">std::size_t maxlevels()</div><div class="ttdef"><b>Definition:</b> kamg.hh:318</div></div>
<div class="ttc" id="aa00243_html_ga4b093095df84e9990eff5581cfe4bfa9"><div class="ttname"><a href="a00243.html#ga4b093095df84e9990eff5581cfe4bfa9">Dune::Amg::AMG::SmootherArgs</a></div><div class="ttdeci">SmootherTraits&lt; Smoother &gt;::Arguments SmootherArgs</div><div class="ttdoc">The argument type for the construction of the smoother.</div><div class="ttdef"><b>Definition:</b> amg.hh:98</div></div>
<div class="ttc" id="aa00243_html_ga66dc78b3214f4ebfc19c8ba3d467d25b"><div class="ttname"><a href="a00243.html#ga66dc78b3214f4ebfc19c8ba3d467d25b">Dune::Amg::AMG::Operator</a></div><div class="ttdeci">M Operator</div><div class="ttdoc">The matrix operator type.</div><div class="ttdef"><b>Definition:</b> amg.hh:71</div></div>
<div class="ttc" id="aa00243_html_ga6dfeef8a854c652e39412a24679055bd"><div class="ttname"><a href="a00243.html#ga6dfeef8a854c652e39412a24679055bd">Dune::Amg::KAMG::post</a></div><div class="ttdeci">void post(Domain &amp;x)</div><div class="ttdoc">Clean up.</div><div class="ttdef"><b>Definition:</b> kamg.hh:291</div></div>
<div class="ttc" id="aa00243_html_ga7c0496b0f7de49193c227a8c93c045d1"><div class="ttname"><a href="a00243.html#ga7c0496b0f7de49193c227a8c93c045d1">Dune::Amg::AMG::Range</a></div><div class="ttdeci">X Range</div><div class="ttdoc">The range type.</div><div class="ttdef"><b>Definition:</b> amg.hh:87</div></div>
<div class="ttc" id="aa00243_html_ga7c53f44b3b6ff7f8ccf90503bc995e11"><div class="ttname"><a href="a00243.html#ga7c53f44b3b6ff7f8ccf90503bc995e11">Dune::Amg::presmooth</a></div><div class="ttdeci">void presmooth(LevelContext &amp;levelContext, size_t steps)</div><div class="ttdoc">Apply pre smoothing on the current level.</div><div class="ttdef"><b>Definition:</b> smoother.hh:404</div></div>
<div class="ttc" id="aa00243_html_gac8448b6118691fd94bc14d2126496c40"><div class="ttname"><a href="a00243.html#gac8448b6118691fd94bc14d2126496c40">Dune::Amg::postsmooth</a></div><div class="ttdeci">void postsmooth(LevelContext &amp;levelContext, size_t steps)</div><div class="ttdoc">Apply post smoothing on the current level.</div><div class="ttdef"><b>Definition:</b> smoother.hh:426</div></div>
<div class="ttc" id="aa00243_html_gaef3e58cdeac191a467f4a8c9cc39ebf4"><div class="ttname"><a href="a00243.html#gaef3e58cdeac191a467f4a8c9cc39ebf4">Dune::Amg::KAMG::pre</a></div><div class="ttdeci">void pre(Domain &amp;x, Range &amp;b)</div><div class="ttdoc">Prepare the preconditioner.</div><div class="ttdef"><b>Definition:</b> kamg.hh:251</div></div>
<div class="ttc" id="aa00243_html_gaf332edc0dc7fcd54a1238811e67f2f29"><div class="ttname"><a href="a00243.html#gaf332edc0dc7fcd54a1238811e67f2f29">Dune::Amg::AMG::category</a></div><div class="ttdeci">virtual SolverCategory::Category category() const</div><div class="ttdoc">Category of the preconditioner (see SolverCategory::Category)</div><div class="ttdef"><b>Definition:</b> amg.hh:192</div></div>
<div class="ttc" id="aa00243_html_gafc3d32c625bd4cabd2481107019b2fb2"><div class="ttname"><a href="a00243.html#gafc3d32c625bd4cabd2481107019b2fb2">Dune::Amg::AMG::ParallelInformation</a></div><div class="ttdeci">PI ParallelInformation</div><div class="ttdoc">The type of the parallel information. Either OwnerOverlapCommunication or another type describing the...</div><div class="ttdef"><b>Definition:</b> amg.hh:78</div></div>
<div class="ttc" id="aa00252_html"><div class="ttname"><a href="a00252.html">Dune</a></div><div class="ttdef"><b>Definition:</b> allocator.hh:9</div></div>
<div class="ttc" id="aa02071_html"><div class="ttname"><a href="a02071.html">Dune::Amg::KAMG</a></div><div class="ttdoc">an algebraic multigrid method using a Krylov-cycle.</div><div class="ttdef"><b>Definition:</b> kamg.hh:138</div></div>
<div class="ttc" id="aa02071_html_a0827421e95230dd79b1964820f5a5188"><div class="ttname"><a href="a02071.html#a0827421e95230dd79b1964820f5a5188">Dune::Amg::KAMG::Domain</a></div><div class="ttdeci">Amg::Domain Domain</div><div class="ttdoc">the type of the domain.</div><div class="ttdef"><b>Definition:</b> kamg.hh:155</div></div>
<div class="ttc" id="aa02071_html_a0c5423c11195465307c453ca3c476cde"><div class="ttname"><a href="a02071.html#a0c5423c11195465307c453ca3c476cde">Dune::Amg::KAMG::SmootherArgs</a></div><div class="ttdeci">Amg::SmootherArgs SmootherArgs</div><div class="ttdoc">The type of the arguments for construction of the smoothers.</div><div class="ttdef"><b>Definition:</b> kamg.hh:151</div></div>
<div class="ttc" id="aa02071_html_a0f2e810563bafd087d53f7b9cdf0f0bb"><div class="ttname"><a href="a02071.html#a0f2e810563bafd087d53f7b9cdf0f0bb">Dune::Amg::KAMG::ParallelInformation</a></div><div class="ttdeci">Amg::ParallelInformation ParallelInformation</div><div class="ttdoc">the type of the parallelinformation to use.</div><div class="ttdef"><b>Definition:</b> kamg.hh:149</div></div>
<div class="ttc" id="aa02071_html_a201cf0811a621236cfaa90f7ab96178b"><div class="ttname"><a href="a02071.html#a201cf0811a621236cfaa90f7ab96178b">Dune::Amg::KAMG::CoarseSolver</a></div><div class="ttdeci">Amg::CoarseSolver CoarseSolver</div><div class="ttdoc">The type of the coarse solver.</div><div class="ttdef"><b>Definition:</b> kamg.hh:147</div></div>
<div class="ttc" id="aa02071_html_a7e3413154b8e7cbf122dfd9fcc35bec3"><div class="ttname"><a href="a02071.html#a7e3413154b8e7cbf122dfd9fcc35bec3">Dune::Amg::KAMG::OperatorHierarchy</a></div><div class="ttdeci">Amg::OperatorHierarchy OperatorHierarchy</div><div class="ttdoc">The type of the hierarchy of operators.</div><div class="ttdef"><b>Definition:</b> kamg.hh:145</div></div>
<div class="ttc" id="aa02071_html_a89bb6e26e7e26da6e251ce76cf259c1b"><div class="ttname"><a href="a02071.html#a89bb6e26e7e26da6e251ce76cf259c1b">Dune::Amg::KAMG::Range</a></div><div class="ttdeci">Amg::Range Range</div><div class="ttdoc">The type of the range.</div><div class="ttdef"><b>Definition:</b> kamg.hh:157</div></div>
<div class="ttc" id="aa02071_html_a9496d834c44a3fb08400f1e2be9915f7"><div class="ttname"><a href="a02071.html#a9496d834c44a3fb08400f1e2be9915f7">Dune::Amg::KAMG::ScalarProduct</a></div><div class="ttdeci">Amg::ScalarProduct ScalarProduct</div><div class="ttdoc">The type of the scalar product.</div><div class="ttdef"><b>Definition:</b> kamg.hh:161</div></div>
<div class="ttc" id="aa02071_html_aadb12fe2c19323e23aeddf5032ade422"><div class="ttname"><a href="a02071.html#aadb12fe2c19323e23aeddf5032ade422">Dune::Amg::KAMG::Amg</a></div><div class="ttdeci">AMG&lt; M, X, S, PI, A &gt; Amg</div><div class="ttdoc">The type of the underlying AMG.</div><div class="ttdef"><b>Definition:</b> kamg.hh:141</div></div>
<div class="ttc" id="aa02071_html_ab39ce79e42d2c9459c0824a9c64bd596"><div class="ttname"><a href="a02071.html#ab39ce79e42d2c9459c0824a9c64bd596">Dune::Amg::KAMG::Operator</a></div><div class="ttdeci">Amg::Operator Operator</div><div class="ttdoc">the type of the lineatr operator.</div><div class="ttdef"><b>Definition:</b> kamg.hh:153</div></div>
<div class="ttc" id="aa02071_html_ab715d269102c8e3cdabc81e0cf11527c"><div class="ttname"><a href="a02071.html#ab715d269102c8e3cdabc81e0cf11527c">Dune::Amg::KAMG::ParallelInformationHierarchy</a></div><div class="ttdeci">Amg::ParallelInformationHierarchy ParallelInformationHierarchy</div><div class="ttdoc">The type of the hierarchy of parallel information.</div><div class="ttdef"><b>Definition:</b> kamg.hh:159</div></div>
<div class="ttc" id="aa02071_html_ad470b061a6d4ce3366da6115827645e1"><div class="ttname"><a href="a02071.html#ad470b061a6d4ce3366da6115827645e1">Dune::Amg::KAMG::category</a></div><div class="ttdeci">virtual SolverCategory::Category category() const</div><div class="ttdoc">Category of the preconditioner (see SolverCategory::Category)</div><div class="ttdef"><b>Definition:</b> kamg.hh:164</div></div>
<div class="ttc" id="aa02071_html_ad67f4d58267ba57613310741f6701b2f"><div class="ttname"><a href="a02071.html#ad67f4d58267ba57613310741f6701b2f">Dune::Amg::KAMG::KrylovSolver</a></div><div class="ttdeci">K KrylovSolver</div><div class="ttdoc">The type of the Krylov solver for the cycle.</div><div class="ttdef"><b>Definition:</b> kamg.hh:143</div></div>
<div class="ttc" id="aa02075_html"><div class="ttname"><a href="a02075.html">Dune::Amg::KAmgTwoGrid</a></div><div class="ttdoc">Two grid operator for AMG with Krylov cycle.</div><div class="ttdef"><b>Definition:</b> kamg.hh:31</div></div>
<div class="ttc" id="aa02075_html_a13659ea8197676a196736be881452f2d"><div class="ttname"><a href="a02075.html#a13659ea8197676a196736be881452f2d">Dune::Amg::KAmgTwoGrid::coarseSolver</a></div><div class="ttdeci">InverseOperator&lt; Domain, Range &gt; * coarseSolver()</div><div class="ttdoc">Get a pointer to the coarse grid solver.</div><div class="ttdef"><b>Definition:</b> kamg.hh:93</div></div>
<div class="ttc" id="aa02075_html_a13d3da72f282e04f2fbbb8e6ee7a4724"><div class="ttname"><a href="a02075.html#a13d3da72f282e04f2fbbb8e6ee7a4724">Dune::Amg::KAmgTwoGrid::KAmgTwoGrid</a></div><div class="ttdeci">KAmgTwoGrid(AMG &amp;amg, std::shared_ptr&lt; InverseOperator&lt; Domain, Range &gt; &gt; coarseSolver)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> kamg.hh:51</div></div>
<div class="ttc" id="aa02075_html_a3a7a6e83e9bec4135ae952799b5efcc2"><div class="ttname"><a href="a02075.html#a3a7a6e83e9bec4135ae952799b5efcc2">Dune::Amg::KAmgTwoGrid::~KAmgTwoGrid</a></div><div class="ttdeci">~KAmgTwoGrid()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> kamg.hh:108</div></div>
<div class="ttc" id="aa02075_html_a8a97df5c3ceb629a4dce6c7258795ed8"><div class="ttname"><a href="a02075.html#a8a97df5c3ceb629a4dce6c7258795ed8">Dune::Amg::KAmgTwoGrid::category</a></div><div class="ttdeci">virtual SolverCategory::Category category() const</div><div class="ttdoc">Category of the preconditioner (see SolverCategory::Category)</div><div class="ttdef"><b>Definition:</b> kamg.hh:39</div></div>
<div class="ttc" id="aa02075_html_a8d82e681993d250da80a5499ed23513e"><div class="ttname"><a href="a02075.html#a8d82e681993d250da80a5499ed23513e">Dune::Amg::KAmgTwoGrid::setLevelContext</a></div><div class="ttdeci">void setLevelContext(std::shared_ptr&lt; typename AMG::LevelContext &gt; p)</div><div class="ttdoc">Set the level context pointer.</div><div class="ttdef"><b>Definition:</b> kamg.hh:102</div></div>
<div class="ttc" id="aa02075_html_a91b79c8509792c0f2a022cff6936b757"><div class="ttname"><a href="a02075.html#a91b79c8509792c0f2a022cff6936b757">Dune::Amg::KAmgTwoGrid::pre</a></div><div class="ttdeci">void pre([[maybe_unused]] typename AMG::Domain &amp;x, [[maybe_unused]] typename AMG::Range &amp;b)</div><div class="ttdoc">Prepare the preconditioner.</div><div class="ttdef"><b>Definition:</b> kamg.hh:56</div></div>
<div class="ttc" id="aa02075_html_aa216ed44cd677a5332cfb977864ba431"><div class="ttname"><a href="a02075.html#aa216ed44cd677a5332cfb977864ba431">Dune::Amg::KAmgTwoGrid::post</a></div><div class="ttdeci">void post([[maybe_unused]] typename AMG::Domain &amp;x)</div><div class="ttdoc">Clean up.</div><div class="ttdef"><b>Definition:</b> kamg.hh:60</div></div>
<div class="ttc" id="aa02075_html_ae7e5b82e07f49643b683c0125ad453eb"><div class="ttname"><a href="a02075.html#ae7e5b82e07f49643b683c0125ad453eb">Dune::Amg::KAmgTwoGrid::apply</a></div><div class="ttdeci">void apply(typename AMG::Domain &amp;v, const typename AMG::Range &amp;d)</div><div class="ttdoc">Apply one step of the preconditioner to the system A(v)=d.</div><div class="ttdef"><b>Definition:</b> kamg.hh:64</div></div>
<div class="ttc" id="aa02079_html"><div class="ttname"><a href="a02079.html">Dune::Amg::AMG</a></div><div class="ttdoc">Parallel algebraic multigrid based on agglomeration.</div><div class="ttdef"><b>Definition:</b> amg.hh:63</div></div>
<div class="ttc" id="aa02343_html"><div class="ttname"><a href="a02343.html">Dune::Amg::Hierarchy&lt; ParallelInformation, Allocator &gt;</a></div></div>
<div class="ttc" id="aa02343_html_a4b48b3288872cb8bccef3b78f287e527"><div class="ttname"><a href="a02343.html#a4b48b3288872cb8bccef3b78f287e527">Dune::Amg::Hierarchy&lt; ParallelInformation, Allocator &gt;::Iterator</a></div><div class="ttdeci">LevelIterator&lt; Hierarchy&lt; ParallelInformation, Allocator &gt;, ParallelInformation &gt; Iterator</div><div class="ttdoc">Type of the mutable iterator.</div><div class="ttdef"><b>Definition:</b> hierarchy.hh:214</div></div>
<div class="ttc" id="aa02375_html"><div class="ttname"><a href="a02375.html">Dune::Amg::MatrixHierarchy</a></div><div class="ttdoc">The hierarchies build by the coarsening process.</div><div class="ttdef"><b>Definition:</b> matrixhierarchy.hh:59</div></div>
<div class="ttc" id="aa02407_html"><div class="ttname"><a href="a02407.html">Dune::Amg::Parameters</a></div><div class="ttdoc">All parameters for AMG.</div><div class="ttdef"><b>Definition:</b> parameters.hh:391</div></div>
<div class="ttc" id="aa02583_html"><div class="ttname"><a href="a02583.html">Dune::Preconditioner</a></div><div class="ttdoc">Base class for matrix free definition of preconditioners.</div><div class="ttdef"><b>Definition:</b> preconditioner.hh:30</div></div>
<div class="ttc" id="aa02639_html"><div class="ttname"><a href="a02639.html">Dune::ScalarProduct</a></div><div class="ttdoc">Base class for scalar product and norm computation.</div><div class="ttdef"><b>Definition:</b> scalarproducts.hh:50</div></div>
<div class="ttc" id="aa02675_html"><div class="ttname"><a href="a02675.html">Dune::InverseOperatorResult</a></div><div class="ttdoc">Statistics about the application of an inverse operator.</div><div class="ttdef"><b>Definition:</b> solver.hh:46</div></div>
<div class="ttc" id="aa02679_html"><div class="ttname"><a href="a02679.html">Dune::InverseOperator</a></div><div class="ttdoc">Abstract base class for all solvers.</div><div class="ttdef"><b>Definition:</b> solver.hh:97</div></div>
<div class="ttc" id="aa02703_html_ae061380ac961490be6ee353cf0dc1733"><div class="ttname"><a href="a02703.html#ae061380ac961490be6ee353cf0dc1733">Dune::SolverCategory::Category</a></div><div class="ttdeci">Category</div><div class="ttdef"><b>Definition:</b> solvercategory.hh:21</div></div>
<div class="ttc" id="aa02763_html"><div class="ttname"><a href="a02763.html">Dune::GeneralizedPCGSolver</a></div><div class="ttdoc">Generalized preconditioned conjugate gradient solver.</div><div class="ttdef"><b>Definition:</b> solvers.hh:1284</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
