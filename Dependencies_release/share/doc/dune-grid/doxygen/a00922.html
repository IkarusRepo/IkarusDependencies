<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dune-grid: GeometryGrid</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dune-grid
   &#160;<span id="projectnumber">2.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">GeometryGrid<div class="ingroups"><a class="el" href="a00905.html">dune-grid</a> &raquo; <a class="el" href="a00921.html">Grid Implementations</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for GeometryGrid:</div>
<div class="dyncontent">
<div class="center"><img src="a00922.png" border="0" usemap="#aa00922" alt=""/></div>
<map name="aa00922" id="aa00922">
<area shape="rect" href="a00921.html" title="A list of the different Implementations of the Dune Grid Interface." alt="" coords="5,5,151,31"/>
<area shape="rect" title=" " alt="" coords="199,5,301,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a03066.html">Dune::GeoGrid::EntityBase&lt; codim, Grid, fake &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">actual implementation of the entity  <a href="a03066.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a03070.html">Dune::GeoGrid::Entity&lt; codim, dim, Grid &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">DUNE-conform implementation of the entity.  <a href="a03070.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a03062.html">Dune::GeometryGrid&lt; HostGrid, CoordFunction, Allocator &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">grid wrapper replacing the geometries  <a href="a03062.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The GeometryGrid is an implementation of the DUNE grid interface that can wrap any other DUNE grid (called host grid) and replace its geometry. To this end, the grid also gets a coordinate function that maps the corners of the host grid into any larger Euklidian space. The generic geometries are then used to provide a geometry implementation for the grid, interpolating the corners in a linear (respectively n-linear) manner.</p>
<div class="image">
<img src="helix.png" alt=""/>
</div>
<p> The figure above displays a <code>GeometryGrid&lt; YaspGrid&lt; 2 &gt;, Helix &gt;</code>, where Helix models the following coordinate function: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left(\begin{array}{c}r\\\varphi\end{array}\right) \mapsto \left(\begin{array}{c} (r + \frac{1}{5}) \cos( 2 \pi \varphi )\\ (r + \frac{1}{5}) \sin( 2 \pi \varphi )\\ \varphi \end{array}\right). \]" src="form_60.png"/>
</p>
<p> Though YaspGrid can only model plane, Carthesian grids, using GeometryGrid we have obtained a nonplanar surface grid with quadrilateral elements.</p>
<h1><a class="anchor" id="features"></a>
Features</h1>
<p>Features of the GeometryGrid include:</p><ul>
<li>Complete wrapper of the host grid (i.e., no non-geometric feature of the host grid is lost)</li>
<li>Only uses the coordinate of the corners of each entity - no other geometric information needs to be provided.</li>
<li>Provides entities for all codimensions, even if the host grid does not (though communication is not extended to these codimensions)</li>
</ul>
<h1><a class="anchor" id="usage"></a>
Usage</h1>
<p>There are two different construction mechanisms for a geometry grid. They differ in how the new geometry is provided.</p><ul>
<li>The geometry can be specified by giving a global functions that maps the world space of the host grid to another Euclidean space. In principle this target space can have any dimension, but in practice its dimension will be larger than or equal to the dimension of the host grid world. The function will be evaluated at the vertex positions of the host grid. It may be given analytically or defined on some grid. In the latter case note, however, that the function arguments are global coordinates and you may have efficiency problems.</li>
<li>The geometry can also be specified by giving a vector containing new positions for each vertex of the host grid.</li>
</ul>
<p>Remark: for the second case no geometry class has to be implemented by the host grid. In the first case the host grid must provide an implementation of the method <code>corner</code> on the geometry class for codimension zero entity.</p>
<p>The approach taken is determined by the second template argument: </p><div class="fragment"><div class="line">GeometryGrid&lt;HostGridType,CoordFunction&gt; grid(hostGrid,coordFunction);</div>
</div><!-- fragment --><p> The class <code>CoordFunction</code> must either be derived from <a class="el" href="a02982.html" title="Derive an implementation of an analytical coordinate function from this class.">Dune::AnalyticalCoordFunction</a> or from <a class="el" href="a02986.html" title="Derive an implementation of a discrete coordinate function from this class.">Dune::DiscreteCoordFunction</a>. If you want to use the first approach derive from <a class="el" href="a02982.html" title="Derive an implementation of an analytical coordinate function from this class.">Dune::AnalyticalCoordFunction</a>. An example of a analytical coordinate function is given by the following code: </p><div class="fragment"><div class="line"><span class="keyword">class </span>ExampleFunction</div>
<div class="line">: <span class="keyword">public</span> <a class="code" href="a00940.html">Dune</a> :: AnalyticalCoordFunction&lt; double, 2, 3, ExampleFunction &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">typedef</span> ExampleFunction This;</div>
<div class="line">  <span class="keyword">typedef</span> Dune :: AnalyticalCoordFunction&lt; double, 2, 3, This &gt; Base;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">typedef</span> Base :: DomainVector DomainVector;</div>
<div class="line">  <span class="keyword">typedef</span> Base :: RangeVector RangeVector;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> evaluate ( <span class="keyword">const</span> DomainVector &amp;x, RangeVector &amp;y )<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    y[ 0 ] = x[ 0 ];</div>
<div class="line">    y[ 1 ] = x[ 1 ];</div>
<div class="line">    y[ 2 ] = x[ 0 ] + x[ 1 ];</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="aa00940_html"><div class="ttname"><a href="a00940.html">Dune</a></div><div class="ttdoc">Include standard header files.</div><div class="ttdef"><b>Definition:</b> agrid.hh:58</div></div>
</div><!-- fragment --><p>If you want to prescribe your geometry by a set of coordinates you have to write a deformation class and have it derive from <a class="el" href="a02986.html" title="Derive an implementation of a discrete coordinate function from this class.">Dune::DiscreteCoordFunction</a>. An example is given by the following code snippet. Central to the class are the two evaluate methods. The first one accepts a host grid vertex and computes its new position. The second one accepts an element and a local corner number and computes the position of this corner. It is trivial to implement this using the first evaluate method, and I don't know why it isn't done by default. </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>View&gt;</div>
<div class="line"><span class="keyword">class </span>DeformationFunction</div>
<div class="line"> : <span class="keyword">public</span> <a class="code" href="a00940.html">Dune</a> :: DiscreteCoordFunction&lt; double, dim, DeformationFunction&lt;GridView&gt; &gt;</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">typedef</span> DeformationFunction&lt;GridView&gt; This;</div>
<div class="line"> <span class="keyword">typedef</span> Dune :: DiscreteCoordFunction&lt; double, dim, This &gt; Base;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line"> DeformationFunction(<span class="keyword">const</span> GridView&amp; gridView,</div>
<div class="line">                     <span class="keyword">const</span> <span class="keywordtype">double</span>* deformedPosition)</div>
<div class="line">     : gridView_(gridView),</div>
<div class="line">       deformedPosition_(deformedPosition)</div>
<div class="line"> {}</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> evaluate ( <span class="keyword">const</span> <span class="keyword">typename</span> GridView::template Codim&lt;dim&gt;::Entity&amp; hostEntity, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> corner,</div>
<div class="line">                 FieldVector&lt;double,dim&gt; &amp;y )<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">typename</span> GridView::IndexSet&amp; indexSet = gridView_.indexSet();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">int</span> idx = indexSet.index(hostEntity);</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim; i++)</div>
<div class="line">         y[i] = deformedPosition_[idx*dim + i];</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> evaluate ( <span class="keyword">const</span> <span class="keyword">typename</span> GridView::template Codim&lt;0&gt;::Entity&amp; hostEntity, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> corner,</div>
<div class="line">                 FieldVector&lt;double,dim&gt; &amp;y )<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"> </span>{</div>
<div class="line"> </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">typename</span> GridView::IndexSet&amp; indexSet = gridView_.indexSet();</div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">int</span> idx = indexSet.subIndex(hostEntity, corner,dim);</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim; i++)</div>
<div class="line">         y[i] = deformedPosition_[idx*dim + i];</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line"> GridView gridView_;</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">double</span>* deformedPosition_;</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
