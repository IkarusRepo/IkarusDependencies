<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dune-geometry: Virtual Refinement</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dune-geometry
   &#160;<span id="projectnumber">2.7.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Virtual Refinement<div class="ingroups"><a class="el" href="a00174.html">Refinement</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Virtual Refinement:</div>
<div class="dyncontent">
<div class="center"><img src="a00175.png" border="0" usemap="#aa00175" alt=""/></div>
<map name="aa00175" id="aa00175">
<area shape="rect" href="a00174.html" title=" " alt="" coords="5,5,92,31"/>
<area shape="rect" title=" " alt="" coords="140,5,268,31"/>
</map>
</div>
<p>Please have a look on the non-virtual <a class="el" href="a00174.html">Refinement</a> documentation.</p>
<h1><a class="anchor" id="Virtual_General"></a>
General</h1>
<p><a class="el" href="a00174.html">Refinement</a> can only be used when you know the geometryType of your entities at compile time. You could circumvent this by using a switch(geometryType), but each case would look very much the same. If you have many such switch() statements, or each case contains lots of code, or you simply have many possible geometryTypes, this can be quiet annoying.</p>
<p>VirtualRefinement does all of this switch() statements for you. It defines a common virtual base class per dimension, and derives one class for each geometryType and coerceTo from that class. The derived classes simply wrap the non-virtual classes from <a class="el" href="a00174.html">Refinement</a>. This makes it possible to treat each geometryType (of a given dimension) the same, and thus eleminates the many repetitions of lots of code.</p>
<p>But the case statements are not totally gone yet. VirtualRefinement does these statements once and for all by wrapping them into the <a class="el" href="a00177.html#a73043181be4688f6cc83f1416cc176c6" title="return a reference to the VirtualRefinement according to the parameters">buildRefinement()</a> function.</p>
<h1><a class="anchor" id="Virtual_User_interface"></a>
The user Interface</h1>
<h2><a class="anchor" id="VirtualRefinement"></a>
The VirtualRefinement class</h2>
<p>When you write a Refinement implementation for a new combination of geometryType and coerceTo, you have to tell <a class="el" href="a00177.html#a73043181be4688f6cc83f1416cc176c6" title="return a reference to the VirtualRefinement according to the parameters">buildRefinement()</a> about it.</p>
<ul>
<li>First, you have to implement the non-virtual part in <a class="el" href="a00174.html">Refinement</a>, if you have not done so yet.</li>
<li>Second, visit the end of refinementvirtual.cc, and look for the specialisations of template&lt;int dimension, class CoordType&gt; class RefinementBuilder. There is one specialisation for each dimension, containing the single method build().</li>
<li>The build() contains two levels of switch statements, the outer for geomentryType and the inner for coerceTo. Each case will either return the correct VirtualRefinement or fall through to the end of the method and throw an error. Insert the cases for your refinement.</li>
</ul>
<p>Everything else has been done for you automatically.</p>
<h2><a class="anchor" id="Virtual_Namespaces"></a>
Namespaces</h2>
<p>The interface is defined by the template class VirtualRefinement. It simply defines the CoordVectors and IndexVectors appropriate for this dimension and CoordType, defines which iterators to use, and provides some proxy or pure virtual functions.</p>
<p>For each class Refinement&lt;geometryType, CoordType, coercTo, dim&gt; we provide a class VirtualRefinementImp&lt;geometryType, CoordType, coercTo, dim&gt;, which wraps the matching class Refinement&lt;geometryType, CoordType, coercTo, dim&gt; and derives from the matching base class VirtualRefinement&lt;dimension, CoordType&gt;. Each VirtualRefinementImp is a singleton and has a static instance() method which will return this instance as a reference to the base class VirtualRefinement. All this is done in a single template class.</p>
<h2><a class="anchor" id="Virtual_Iterators"></a>
The iterators</h2>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
